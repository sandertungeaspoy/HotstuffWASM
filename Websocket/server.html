<html>
	<head>
		<meta charset="utf-8"/>
		<script src="wasm_exec.js"></script>
		<script>
			const go = new Go();
			WebAssembly.instantiateStreaming(fetch("dial.wasm"), go.importObject).then(
				result => {
          			mod = result.module;
          			inst = result.instance;
          			document.getElementById("runButton").disabled = false;
        		}
      		);

      		async function run() {
        		await go.run(inst);
        		inst = await WebAssembly.instantiate(mod, go.importObject); // reset instance
      		}
		</script>
		<script type = "text/javascript">
			function WebSocketTest() {
			   
			   if ("WebSocket" in window) {
				  alert("WebSocket is supported by your Browser!");
				  
				  // Let us open a web socket
				  var ws = new WebSocket("ws://localhost:13371");
				   
				  ws.onopen = function() {
					 
					 // Web Socket is connected, send data using send()
					 ws.send("Message to send");
					 alert("Message is sent...");
				  };
				   
				  ws.onmessage = function (evt) { 
					 var received_msg = evt.data;
					 alert("Message is received...");
				  };
				   
				  ws.onclose = function() { 
					 
					 // websocket is closed.
					 alert("Connection is closed..."); 
				  };
			   } else {
				 
				  // The browser doesn't support WebSocket
				  alert("WebSocket NOT supported by your Browser!");
			   }
			}
		 </script>
	</head>
	<body>
		<h1>HotStuff WASM Server</h1>
			Self-ID:<input type="number" id="self-id" step="1" min="1" max="4" name="Server ID" value="1">
			
			<button onClick="GetSelfID('self-id');" id="idButton">Assign</button>
			Chat:<input type="text" id="text" name="charbox" value="Test">
			<button onClick="SendChat('text');" id="chatButton">Send</button>
			<button onClick="run();" id="runButton" disabled>Run</button>
	</body>
</html>